digraph behaviourmodel {


# activity title
labelloc="t"
label="A21 Extract Tool Trajectory"

# task definition
node [shape=box, style="filled, rounded", fillcolor=red, color=black]
Start
t1 [label="Read next line"]
t2 [label="Calculate time"]
t3 [label="Write results"]
End

# mechanisms
node [shape=box, style=filled, fillcolor=green, color=black]
script [label="Script"]

# rules
node [shape=box, style=filled, fillcolor=yellow, color=black]
r1 [label="Read line,\ntest if it is motion\nand get variables"]
r2 [label="Calculate path lenght:\ntime = lenght/feedrate"]
r3 [label="Append results in 3 documents:\n(time, X), (time, Y), (time, Z)"]

# task sequence
edge [dir=forward, color=red, style=solid]
{rank=same
    Start -> t1
    t1 -> t1 [label="no motion"]
    t1 -> t2 [label="(feedrate, X, Y, Z)"]
    t2 -> t3 [label="(time, X, Y, Z)"]
    t3 -> t1 [label="iterate"]
    t3 -> End
}

# attaching mechanisms
edge [dir=forward, color=black]
script -> {t1 t2 t3}

# attaching rules
edge [dir=forward, color=black, style=dotted]
t1 -> r1
t2 -> r2
t3 -> r3


# input and output definition
node [shape=ellipse, style=filled, fillcolor=white, color=black]
nc [label="NC Program"]
path [label="Tool Trayectory"]

# attaching inputs and outputs
edge [dir=forward, color=black, style=solid]
nc -> t1
t3 -> path

}

